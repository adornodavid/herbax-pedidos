<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Pedidos HBX - Portal Distribuidores</title>
    <style>
        :root {
            --herbax-primary: #3fae29;
            --herbax-secondary: #c4d82e;
            --herbax-gray: #374E5A;
            --herbax-light: #f8f9fa;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .header {
            background: var(--herbax-primary);
            color: white;
            padding: 30px;
            border-radius: 20px 20px 0 0;
            text-align: center;
            margin-bottom: 0;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            cursor: pointer;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .help-banner {
            background: var(--herbax-secondary);
            color: var(--herbax-gray);
            padding: 15px;
            text-align: center;
            font-weight: 500;
        }

        .progress-bar {
            background: #e5e7eb;
            height: 8px;
            border-radius: 4px;
            margin: 30px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: var(--herbax-primary);
            height: 100%;
            transition: width 0.3s ease;
        }

        .step-container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            display: none;
        }

        .step-container.active {
            display: block;
        }

        .step-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--herbax-light);
        }

        .step-number {
            background: var(--herbax-primary);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0 auto 15px;
        }

        .step-title {
            font-size: 1.8rem;
            color: var(--herbax-primary);
            margin-bottom: 10px;
        }

        .step-description {
            color: var(--herbax-gray);
            font-size: 1.1rem;
        }

        .country-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .country-option {
            background: white;
            border: 3px solid #e5e7eb;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .country-option:hover {
            border-color: var(--herbax-primary);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(63, 174, 41, 0.2);
        }

        .country-option.selected {
            border-color: var(--herbax-primary);
            background: rgba(63, 174, 41, 0.05);
        }

        .country-flag {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .country-name {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--herbax-gray);
            margin-bottom: 8px;
        }

        .country-currency {
            color: var(--herbax-primary);
            font-weight: 500;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--herbax-gray);
        }

        .form-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--herbax-primary);
        }

        .search-container {
            position: relative;
        }

        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid var(--herbax-primary);
            border-top: none;
            border-radius: 0 0 10px 10px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        .search-result {
            padding: 15px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
        }

        .search-result:hover {
            background: var(--herbax-light);
        }

        .help-text {
            font-size: 0.9rem;
            color: #666;
            margin-top: 8px;
        }

        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 150px;
        }

        .btn-primary {
            background: var(--herbax-primary);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2d8a1f;
            transform: translateY(-2px);
        }

        .btn-primary:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #545b62;
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .product-card {
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            padding: 20px;
            background: white;
        }

        .product-name {
            font-weight: bold;
            color: var(--herbax-primary);
            margin-bottom: 5px;
        }

        .product-sku {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .product-price {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--herbax-gray);
            margin-bottom: 15px;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quantity-btn {
            width: 35px;
            height: 35px;
            border: 2px solid var(--herbax-primary);
            background: white;
            color: var(--herbax-primary);
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .quantity-btn:hover {
            background: var(--herbax-primary);
            color: white;
        }

        .quantity-input {
            width: 60px;
            text-align: center;
            border: 2px solid #e5e7eb;
            border-radius: 5px;
            padding: 5px;
        }

        .confirmation-screen {
            display: none;
            text-align: center;
            padding: 40px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .confirmation-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .confirmation-title {
            font-size: 2rem;
            color: var(--herbax-primary);
            margin-bottom: 15px;
            font-weight: bold;
        }

        .confirmation-message {
            font-size: 1.1rem;
            color: var(--herbax-gray);
            margin-bottom: 30px;
        }

        .order-summary-card {
            background: var(--herbax-light);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            text-align: left;
        }

        .back-to-home-btn {
            background: var(--herbax-primary);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .back-to-home-btn:hover {
            background: #2d8a1f;
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .step-container {
                padding: 20px;
            }
            
            .button-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
         <CHANGE> Header simplificado con logo clickeable 
        <div class="header">
            <h1 onclick="goToHome()">üõçÔ∏è Sistema de Pedidos HBX</h1>
            <p>Portal Exclusivo para Distribuidores</p>
        </div>

        <div class="help-banner">
            <strong>¬øNecesitas ayuda?</strong><br>
            Llama al Centro de Atenci√≥n CADI: <strong>800 649 0653</strong>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 20%"></div>
        </div>

         Paso 1: Selecci√≥n de Pa√≠s 
        <div class="step-container active" id="step1">
            <div class="step-header">
                <div class="step-number">1</div>
                <h2 class="step-title">Selecciona tu Pa√≠s</h2>
                <p class="step-description">
                    Primero necesitamos saber desde qu√© pa√≠s nos est√°s escribiendo.<br>
                    Esto nos ayudar√° a mostrarte los productos y precios correctos.
                </p>
                <p style="font-size: 0.9rem; color: #666; margin-top: 10px;"><strong>Sistema exclusivo para Centros de Distribuci√≥n</strong></p>
            </div>

            <div class="country-grid">
                <div class="country-option" data-country="mexico" data-currency="MXN" data-symbol="$">
                    <div class="country-flag">üá≤üáΩ</div>
                    <div class="country-name">M√©xico</div>
                    <div class="country-currency">Precios en Pesos Mexicanos</div>
                </div>
                <div class="country-option" data-country="guatemala" data-currency="GTQ" data-symbol="Q">
                    <div class="country-flag">üá¨üáπ</div>
                    <div class="country-name">Guatemala</div>
                    <div class="country-currency">Precios en Quetzales</div>
                </div>
                <div class="country-option" data-country="usa" data-currency="USD" data-symbol="$">
                    <div class="country-flag">üá∫üá∏</div>
                    <div class="country-name">Estados Unidos</div>
                    <div class="country-currency">Precios en D√≥lares</div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-primary" id="nextStep1" disabled>
                    Continuar al Paso 2 ‚Üí
                </button>
            </div>
        </div>

         Paso 2: Selecci√≥n de Almac√©n 
        <div class="step-container" id="step2">
            <div class="step-header">
                <div class="step-number">2</div>
                <h2 class="step-title">Selecciona tu Centro de Distribuci√≥n</h2>
                <p class="step-description">
                    Ahora necesitamos saber a qu√© almac√©n o centro de distribuci√≥n perteneces.<br>
                    Puedes buscarlo o llenar los datos manualmente.
                </p>
            </div>

            <div class="form-group">
                <label class="form-label">Buscar mi Centro de Distribuci√≥n</label>
                <div class="search-container">
                    <input type="text" class="form-input" id="warehouseSearch" 
                           placeholder="Escribe el nombre del almac√©n o ciudad">
                    <div class="search-results" id="warehouseSearchResults"></div>
                </div>
                <div class="help-text">
                    <strong>Ejemplos de b√∫squeda:</strong><br>
                    ‚Ä¢ Por ciudad: "Monterrey", "Ciudad de M√©xico", "Guadalajara"<br>
                    ‚Ä¢ Por nombre: "Almac√©n Central", "Centro Norte"
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">Nombre del Almac√©n *</label>
                <input type="text" class="form-input" id="warehouseName" required>
            </div>

            <div class="form-group">
                <label class="form-label">Ciudad *</label>
                <input type="text" class="form-input" id="warehouseCity" required>
            </div>

            <div class="form-group">
                <label class="form-label">Correo del Almac√©n *</label>
                <input type="email" class="form-input" id="warehouseEmail" required>
            </div>

            <div class="form-group">
                <label class="form-label">Tel√©fono del Almac√©n *</label>
                <input type="tel" class="form-input" id="warehousePhone" required>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" id="backStep2">‚Üê Regresar</button>
                <button class="btn btn-primary" id="nextStep2">Continuar al Paso 3 ‚Üí</button>
            </div>
        </div>

         Paso 3: Informaci√≥n del Distribuidor 
        <div class="step-container" id="step3">
            <div class="step-header">
                <div class="step-number">3</div>
                <h2 class="step-title">Informaci√≥n del Distribuidor</h2>
                <p class="step-description">
                    Ahora necesitamos tus datos como distribuidor de Herbax.<br>
                    Si ya eres distribuidor, puedes buscar tu informaci√≥n para que se llene autom√°ticamente.
                </p>
            </div>

            <div class="form-group">
                <label class="form-label">Buscar mi informaci√≥n de distribuidor</label>
                <div class="search-container">
                    <input type="text" class="form-input" id="distributorSearch" 
                           placeholder="Escribe tu ID de distribuidor, nombre, tel√©fono o correo">
                    <div class="search-results" id="searchResults"></div>
                </div>
                <div class="help-text">
                    <div style="background: #fef3c7; border: 1px solid #f59e0b; border-radius: 8px; padding: 15px; margin: 15px 0;">
                        <h4 style="color: #92400e; margin-bottom: 10px; font-weight: bold;">¬øC√≥mo es mi ID de distribuidor?</h4>
                        <div style="color: #92400e; font-size: 0.9rem;">
                            <p>‚Ä¢ <strong>M√©xico:</strong> N√∫meros secuenciales (ejemplo: 66, 67, 68...)</p>
                            <p>‚Ä¢ <strong>Guatemala:</strong> Empieza con GT (ejemplo: GT002, GT003...)</p>
                            <p>‚Ä¢ <strong>Estados Unidos:</strong> Empieza con US (ejemplo: US002, US003...)</p>
                            <p style="font-size: 0.8rem; margin-top: 8px; font-style: italic;">* Los IDs que empiezan con "P" son solo para pruebas</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">ID de Distribuidor *</label>
                <input type="text" class="form-input" id="distributorId" required>
            </div>

            <div class="form-group">
                <label class="form-label">Nombre Completo *</label>
                <input type="text" class="form-input" id="distributorName" required>
            </div>

            <div class="form-group">
                <label class="form-label">Correo Electr√≥nico *</label>
                <input type="email" class="form-input" id="distributorEmail" required>
            </div>

            <div class="form-group">
                <label class="form-label">Confirmar Correo Electr√≥nico *</label>
                <input type="email" class="form-input" id="distributorEmailConfirm" required>
            </div>

            <div class="form-group">
                <label class="form-label">Tel√©fono *</label>
                <input type="tel" class="form-input" id="distributorPhone" required>
            </div>

            <div class="form-group">
                <label class="form-label">Direcci√≥n *</label>
                <input type="text" class="form-input" id="distributorAddress" required>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" id="backStep3">‚Üê Regresar</button>
                <button class="btn btn-primary" id="nextStep3">Continuar al Paso 4 ‚Üí</button>
            </div>
        </div>

         Paso 4: Selecci√≥n de Productos 
        <div class="step-container" id="step4">
            <div class="step-header">
                <div class="step-number">4</div>
                <h2 class="step-title">Selecciona tus Productos</h2>
                <p class="step-description">
                    Aqu√≠ puedes elegir los productos que deseas ordenar.<br>
                    Los precios mostrados son <strong>SIN impuestos</strong>.
                </p>
            </div>

            <div class="form-group">
                <label class="form-label">Buscar productos</label>
                <input type="text" class="form-input" id="productSearch" 
                       placeholder="Busca por nombre del producto o SKU (ejemplo: RIM, 26-02, Magnotun)">
                <div class="help-text">
                    <strong>Tip:</strong> Puedes buscar por nombre del producto o por su c√≥digo SKU
                </div>
            </div>

            <div id="productList" class="product-grid">
                 Los productos se cargar√°n aqu√≠ 
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" id="backStep4">‚Üê Regresar</button>
                <button class="btn btn-primary" id="nextStep4">Ver Resumen del Pedido ‚Üí</button>
            </div>
        </div>

         Paso 5: Confirmaci√≥n 
        <div class="step-container" id="step5">
            <div class="step-header">
                <div class="step-number">5</div>
                <h2 class="step-title">Confirma tu Pedido</h2>
                <p class="step-description">
                    Revisa que toda la informaci√≥n est√© correcta antes de enviar tu pedido.
                </p>
            </div>

            <div id="orderSummary">
                 El resumen se cargar√° aqu√≠ 
            </div>

            <div class="form-group">
                <label class="form-label">M√©todo de Pago *</label>
                <select class="form-input" id="paymentMethod" required>
                    <option value="">Selecciona un m√©todo de pago</option>
                    <option value="referencia">Referencia Bancaria Santander</option>
                    <option value="deposito">Dep√≥sito Bancario Banregio</option>
                    <option value="tarjeta">Tarjeta Bancaria</option>
                </select>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" id="backStep5">‚Üê Regresar</button>
                <button class="btn btn-primary" id="submitOrder" disabled>Enviar Pedido</button>
            </div>
        </div>

         Pantalla de confirmaci√≥n 
        <div id="confirmationScreen" class="confirmation-screen">
            <div class="confirmation-icon">‚úÖ</div>
            <div class="confirmation-title">¬°Pedido Enviado Exitosamente!</div>
            <div class="confirmation-message">
                Tu pedido ha sido enviado correctamente y ser√° procesado por nuestro equipo.<br>
                Recibir√°s una confirmaci√≥n por correo electr√≥nico en breve.
            </div>
            
            <div class="order-summary-card">
                <h3 style="color: var(--herbax-primary); margin-bottom: 15px;">üìã Resumen de tu Pedido</h3>
                <div id="finalOrderSummary"></div>
            </div>

            <button class="back-to-home-btn" onclick="goToHome()">
                üè† Regresar al Inicio
            </button>
        </div>
    </div>

    <script>
        // <CHANGE> Variables globales y datos consolidados
        let currentStep = 1;
        let selectedCountry = null;
        let selectedCurrency = 'MXN';
        let selectedSymbol = '$';
        let cart = [];

        // Datos de almacenes por pa√≠s
        const warehouseData = {
            mexico: [
                { id: 'CADI-MTY', name: 'CADI Monterrey', city: 'Monterrey', email: 'monterrey@cadi.com', phone: '800-649-0653' },
                { id: 'CADI-CDMX', name: 'CADI Ciudad de M√©xico', city: 'Ciudad de M√©xico', email: 'cdmx@cadi.com', phone: '800-649-0653' },
                { id: 'CADI-GDL', name: 'CADI Guadalajara', city: 'Guadalajara', email: 'guadalajara@cadi.com', phone: '800-649-0653' },
                { id: 'CADI-TIJ', name: 'CADI Tijuana', city: 'Tijuana', email: 'tijuana@cadi.com', phone: '800-649-0653' }
            ],
            guatemala: [
                { id: 'HBX-GT01', name: 'Centro Guatemala Norte', city: 'Guatemala City', email: 'guatemala@herbax.com', phone: '+502-2345-6789' },
                { id: 'HBX-GT02', name: 'Centro Quetzaltenango', city: 'Quetzaltenango', email: 'quetzal@herbax.com', phone: '+502-7765-4321' }
            ],
            usa: [
                { id: 'HBX-US01', name: 'Distribution Center Miami', city: 'Miami', email: 'miami@herbax.com', phone: '+1-305-555-0123' },
                { id: 'HBX-US02', name: 'Distribution Center Los Angeles', city: 'Los Angeles', email: 'la@herbax.com', phone: '+1-213-555-0456' },
                { id: 'HBX-US03', name: 'Distribution Center Houston', city: 'Houston', email: 'houston@herbax.com', phone: '+1-713-555-0789' }
            ]
        };

        // Datos de distribuidores por pa√≠s
        const sampleDistributors = {
            mexico: [
                { id: 'PMX001', name: 'David Adorno (PRUEBA)', email: 'adorno.david@gmail.com', phone: '8110669931', address: 'Eje Exterior 14, Via Cordillera, Nuevo Le√≥n, 66196', country: 'Mexico' },
                { id: '66', name: 'Mar√≠a Elena Gonz√°lez Hern√°ndez', email: 'maria.gonzalez@herbax.com', phone: '5512345678', address: 'Av. Insurgentes 1234, Col. Roma Norte, CDMX, 06700', country: 'Mexico' },
                { id: '67', name: 'Carlos Roberto Mart√≠nez L√≥pez', email: 'carlos.martinez@herbax.com', phone: '3398765432', address: 'Calle Morelos 567, Col. Centro, Guadalajara, 44100', country: 'Mexico' },
                { id: '68', name: 'Ana Patricia Rodr√≠guez S√°nchez', email: 'ana.rodriguez@herbax.com', phone: '8187654321', address: 'Blvd. D√≠az Ordaz 890, Col. Santa Mar√≠a, Monterrey, 64650', country: 'Mexico' }
            ],
            guatemala: [
                { id: 'PGUA001', name: 'David Adorno (PRUEBA)', email: 'adorno.david@gmail.com', phone: '8110669931', address: 'Eje Exterior 14, Via Cordillera, Guatemala', country: 'Guatemala' },
                { id: 'GT002', name: 'Jos√© Manuel P√©rez Morales', email: 'jose.perez@herbax.com', phone: '+502-5555-1234', address: '12 Calle 3-45, Zona 1, Guatemala City', country: 'Guatemala' },
                { id: 'GT003', name: 'Carmen Luc√≠a Hern√°ndez V√°squez', email: 'carmen.hernandez@herbax.com', phone: '+502-4444-5678', address: '8va Avenida 15-20, Zona 9, Guatemala City', country: 'Guatemala' }
            ],
            usa: [
                { id: 'PUSA001', name: 'David Adorno (PRUEBA)', email: 'adorno.david@gmail.com', phone: '8110669931', address: 'Eje Exterior 14, Via Cordillera, Estados Unidos', country: 'Estados Unidos' },
                { id: 'US002', name: 'Michael Johnson Smith', email: 'michael.johnson@herbax.com', phone: '+1-305-555-9876', address: '1234 Ocean Drive, Miami Beach, FL 33139', country: 'Estados Unidos' },
                { id: 'US003', name: 'Jennifer Mar√≠a Garc√≠a', email: 'jennifer.garcia@herbax.com', phone: '+1-213-555-5432', address: '5678 Sunset Blvd, Los Angeles, CA 90028', country: 'Estados Unidos' }
            ]
        };

        // Datos de productos por pa√≠s (versi√≥n simplificada para testing)
        const productData = {
            mexico: [
                { sku: '1', name: 'Difest', price: 292.24, qualifyingPoints: 42.38, commissionPoints: 36.53 },
                { sku: '1A', name: 'Vitamina C', price: 223.28, qualifyingPoints: 32.38, commissionPoints: 27.91 },
                { sku: '2-03', name: 'Rim Plus', price: 327.59, qualifyingPoints: 47.50, commissionPoints: 40.95 },
                { sku: '4', name: 'Cobex', price: 219.83, qualifyingPoints: 31.88, commissionPoints: 27.48 }
            ],
            guatemala: [
                { sku: '26-02', name: 'RIM', price: 133.03, qualifyingPoints: 37.25, commissionPoints: 33.26 },
                { sku: '09-03', name: 'TESY', price: 133.03, qualifyingPoints: 37.25, commissionPoints: 33.26 },
                { sku: '2-02', name: 'RIM PLUS', price: 133.03, qualifyingPoints: 37.25, commissionPoints: 33.26 },
                { sku: '06-02', name: 'DEBET', price: 133.03, qualifyingPoints: 37.25, commissionPoints: 33.26 }
            ],
            usa: [
                { sku: '01-02', name: 'DIFEST-1', price: 23.69, qualifyingPoints: 39.48, commissionPoints: 39.48 },
                { sku: '1A', name: 'GATILOE-10', price: 25.79, qualifyingPoints: 42.98, commissionPoints: 42.98 },
                { sku: '11-03', name: 'HIPEN-11', price: 15.49, qualifyingPoints: 25.82, commissionPoints: 25.82 },
                { sku: '13-02', name: 'DONDX-13', price: 15.49, qualifyingPoints: 25.82, commissionPoints: 25.82 }
            ]
        };

        // <CHANGE> Inicializaci√≥n cuando se carga la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            console.log('[v0] DOM loaded, initializing...');
            initializeEventListeners();
            showStep(1);
        });

        function initializeEventListeners() {
            console.log('[v0] Setting up event listeners...');
            
            // Selecci√≥n de pa√≠s
            document.querySelectorAll('.country-option').forEach(option => {
                option.addEventListener('click', function() {
                    selectCountry(this.dataset.country, this.dataset.currency, this.dataset.symbol);
                });
            });

            // Botones de navegaci√≥n
            document.getElementById('nextStep1').addEventListener('click', () => goToStep(2));
            document.getElementById('nextStep2').addEventListener('click', () => goToStep(3));
            document.getElementById('nextStep3').addEventListener('click', () => goToStep(4));
            document.getElementById('nextStep4').addEventListener('click', () => goToStep(5));

            document.getElementById('backStep2').addEventListener('click', () => goToStep(1));
            document.getElementById('backStep3').addEventListener('click', () => goToStep(2));
            document.getElementById('backStep4').addEventListener('click', () => goToStep(3));
            document.getElementById('backStep5').addEventListener('click', () => goToStep(4));

            // B√∫squedas
            document.getElementById('warehouseSearch').addEventListener('input', searchWarehouse);
            document.getElementById('distributorSearch').addEventListener('input', searchDistributor);
            document.getElementById('productSearch').addEventListener('input', searchProducts);

            // M√©todo de pago y env√≠o
            document.getElementById('paymentMethod').addEventListener('change', updateSubmitButton);
            document.getElementById('submitOrder').addEventListener('click', submitOrder);
        }

        function selectCountry(country, currency, symbol) {
            console.log('[v0] Country selected:', country);
            
            // Remover selecci√≥n anterior
            document.querySelectorAll('.country-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Seleccionar nuevo pa√≠s
            document.querySelector(`[data-country="${country}"]`).classList.add('selected');
            
            selectedCountry = country;
            selectedCurrency = currency;
            selectedSymbol = symbol;
            
            // Habilitar bot√≥n siguiente
            document.getElementById('nextStep1').disabled = false;
        }

        function goToStep(step) {
            console.log('[v0] goToStep called with step:', step);
            
            // Validar paso actual antes de continuar
            if (!validateCurrentStep()) {
                return;
            }

            // Ocultar todos los pasos
            document.querySelectorAll('.step-container').forEach(container => {
                container.classList.remove('active');
            });
            
            // Mostrar paso actual
            document.getElementById(`step${step}`).classList.add('active');
            currentStep = step;
            
            // Actualizar barra de progreso
            const progress = (step / 5) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
            
            // Cargar contenido espec√≠fico del paso
            if (step === 4) {
                loadProducts();
            } else if (step === 5) {
                updateConfirmationSummary();
                updateSubmitButton();
            }
        }

        function validateCurrentStep() {
            console.log('[v0] validateCurrentStep called, currentStep:', currentStep);
            
            if (currentStep === 1) {
                if (!selectedCountry) {
                    alert('Por favor selecciona un pa√≠s antes de continuar.');
                    return false;
                }
                return true;
            }
            
            if (currentStep === 2) {
                const warehouseName = document.getElementById('warehouseName').value;
                const warehouseCity = document.getElementById('warehouseCity').value;
                const warehouseEmail = document.getElementById('warehouseEmail').value;
                const warehousePhone = document.getElementById('warehousePhone').value;
                
                if (!warehouseName || !warehouseCity || !warehouseEmail || !warehousePhone) {
                    alert('Por favor completa todos los campos del almac√©n.');
                    return false;
                }
                return true;
            }
            
            if (currentStep === 3) {
                const distributorId = document.getElementById('distributorId').value;
                const distributorName = document.getElementById('distributorName').value;
                const distributorEmail = document.getElementById('distributorEmail').value;
                const distributorEmailConfirm = document.getElementById('distributorEmailConfirm').value;
                const distributorPhone = document.getElementById('distributorPhone').value;
                const distributorAddress = document.getElementById('distributorAddress').value;
                
                if (!distributorId || !distributorName || !distributorEmail || !distributorEmailConfirm || !distributorPhone || !distributorAddress) {
                    alert('Por favor completa todos los campos del distribuidor.');
                    return false;
                }
                
                if (distributorEmail !== distributorEmailConfirm) {
                    alert('Los correos electr√≥nicos no coinciden.');
                    return false;
                }
                return true;
            }
            
            if (currentStep === 4) {
                if (cart.length === 0) {
                    alert('Por favor selecciona al menos un producto.');
                    return false;
                }
                return true;
            }
            
            return true;
        }

        function searchWarehouse() {
            const query = document.getElementById('warehouseSearch').value.toLowerCase();
            const results = document.getElementById('warehouseSearchResults');
            
            if (query.length < 2) {
                results.style.display = 'none';
                return;
            }
            
            const warehouses = warehouseData[selectedCountry] || [];
            const filtered = warehouses.filter(warehouse => 
                warehouse.name.toLowerCase().includes(query) || 
                warehouse.city.toLowerCase().includes(query)
            );
            
            if (filtered.length > 0) {
                results.innerHTML = filtered.map(warehouse => 
                    `<div class="search-result" onclick="selectWarehouse('${warehouse.id}')">
                        <strong>${warehouse.name}</strong><br>
                        ${warehouse.city} | ${warehouse.email} | ${warehouse.phone}
                    </div>`
                ).join('');
                results.style.display = 'block';
            } else {
                results.style.display = 'none';
            }
        }

        function selectWarehouse(warehouseId) {
            const warehouses = warehouseData[selectedCountry] || [];
            const warehouse = warehouses.find(w => w.id === warehouseId);
            
            if (warehouse) {
                document.getElementById('warehouseName').value = warehouse.name;
                document.getElementById('warehouseCity').value = warehouse.city;
                document.getElementById('warehouseEmail').value = warehouse.email;
                document.getElementById('warehousePhone').value = warehouse.phone;
                document.getElementById('warehouseSearchResults').style.display = 'none';
            }
        }

        function searchDistributor() {
            const query = document.getElementById('distributorSearch').value.toLowerCase();
            const results = document.getElementById('searchResults');
            
            if (query.length < 2) {
                results.style.display = 'none';
                return;
            }
            
            const distributors = sampleDistributors[selectedCountry] || [];
            const filtered = distributors.filter(distributor => 
                distributor.id.toLowerCase().includes(query) ||
                distributor.name.toLowerCase().includes(query) ||
                distributor.email.toLowerCase().includes(query) ||
                distributor.phone.includes(query)
            );
            
            if (filtered.length > 0) {
                results.innerHTML = filtered.map(distributor => 
                    `<div class="search-result" onclick="selectDistributor('${distributor.id}')">
                        <strong>${distributor.id} - ${distributor.name}</strong><br>
                        ${distributor.email} | ${distributor.phone}
                    </div>`
                ).join('');
                results.style.display = 'block';
            } else {
                results.style.display = 'none';
            }
        }

        function selectDistributor(distributorId) {
            const distributors = sampleDistributors[selectedCountry] || [];
            const distributor = distributors.find(d => d.id === distributorId);
            
            if (distributor) {
                document.getElementById('distributorId').value = distributor.id;
                document.getElementById('distributorName').value = distributor.name;
                document.getElementById('distributorEmail').value = distributor.email;
                document.getElementById('distributorEmailConfirm').value = distributor.email;
                document.getElementById('distributorPhone').value = distributor.phone;
                document.getElementById('distributorAddress').value = distributor.address;
                document.getElementById('searchResults').style.display = 'none';
            }
        }

        function loadProducts() {
            const products = productData[selectedCountry] || [];
            const productList = document.getElementById('productList');
            
            productList.innerHTML = products.map(product => 
                `<div class="product-card">
                    <div class="product-name">${product.name}</div>
                    <div class="product-sku">SKU: ${product.sku}</div>
                    <div class="product-price">${selectedSymbol}${product.price.toFixed(2)} (SIN IVA)</div>
                    <div class="quantity-controls">
                        <button class="quantity-btn" onclick="updateQuantity('${product.sku}', -1)">-</button>
                        <input type="number" class="quantity-input" id="qty-${product.sku}" value="0" min="0" onchange="updateQuantity('${product.sku}', 0)">
                        <button clas
